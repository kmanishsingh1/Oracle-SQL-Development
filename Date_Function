
/*

Date :- 26-April-2020
Author :- Manish K Singh
Purpose :- Some useful data filter logic based on DATE 
Environment :- Tested in Oracle 12c DATABASE

*/

DROP TABLE TEST_DATE;

CREATE TABLE TEST_DATE (PRODUCT_NAME NVARCHAR2(30),EXPIRY_DATE DATE,INSERTION_DATE DATE);

SELECT * FROM TEST_DATE;


--1. TO FILTER DATA BETWEEN DATA RANGE [Between date_1 to date_2]

SELECT
    PRODUCT_NAME AS "PRODUCT NAME",
    INSERTION_DATE AS "MANUFACTURE DATE" 
FROM TEST_DATE 
WHERE TO_DATE(TO_CHAR(INSERTION_DATE,'YYYY-MM-DD'),'YYYY-MM-DD')
BETWEEN TO_DATE('2020-04-01','YYYY-MM-DD') AND TO_DATE('2020-04-26','YYYY-MM-DD');

--2. TO FILTER DATA COMPLETE DATA TILL TODAY 

SELECT
    PRODUCT_NAME AS "PRODUCT NAME",
    INSERTION_DATE AS "MANUFACTURE DATE"
FROM TEST_DATE
WHERE TO_DATE(TO_CHAR(INSERTION_DATE,'YYYY-MM-DD'),'YYYY-MM-DD') <=  TO_DATE('2020-04-27','YYYY-MM-DD');

--3. TO FILTER DATA ONLY LAST DAY 

SELECT 
    PRODUCT_NAME AS "PRODUCT NAME",
    INSERTION_DATE AS "MANUFACTURE DATE"
FROM TEST_DATE 
WHERE TRUNC(INSERTION_DATE) = TRUNC(SYSDATE-1);

--4. TO COMPARE DATE 

SELECT 
    PRODUCT_NAME AS "PRODUCT NAME",
    INSERTION_DATE "MANUFACTURE DATE",
    EXPIRY_DATE  AS "EXPIRY DATE"
FROM TEST_DATE 
WHERE TO_DATE(TO_CHAR(INSERTION_DATE,'YYYY-MM-DD'),'YYYY-MM-DD') <= TO_DATE(TO_CHAR(EXPIRY_DATE,'YYYY-MM-DD'),'YYYY-MM-DD');


5 - To Select complete month data 
SELECT * FROM Table_name where 
TO_DATE(B.TRAN_DATE,'DD-MM-YYYY') BETWEEN add_months(trunc(sysdate, 'month'), -1) AND trunc(sysdate, 'month')-1);


6 - To Select Current Quarter data
SELECT
  TRUNC(SYSDATE, 'Q')AS FIRST_DAY,
  last_day(add_months(TRUNC(SYSDATE, 'Q'),2)) as LAST_DAY                
FROM DUAL;


/*
From Oracle Docs - 
A later date is considered greater than an earlier one.
For example-
The date equivalent of '29-MAR-2005' is less than that of '05-JAN-2006' and '05-JAN-2006 1:35pm' is greater than '05-JAN-2005 10:09am'.

*/


